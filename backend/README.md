# nutritioner-backend 

Бэкенд сервис, который предоставляет REST API для Телеграм-бота - трэкера калорий с использваннием ИИ.

Зависит от: контейнера с БД postgres, API ollama, API Nutrionix. 

### I этап разработки 

Предоставляет один эндпоинт `POST /api/v1/meals` 

Request body: 
```ts
{
    user_id: string // ID пользователя, который отправил запрос (задача аутентикации решается на стороне бота)
    description: string // сырой текст, который ввёл пользователь, описывая приём пищи. Например: "я пообедал тарелкой супа, тарелкой риса и куриной котлетой" 
}
```
Эти данные отправляются в LLM через API ollama с определённым промптом, модель возвращает примерное количество калорий, соответствующее этому приёму пищи (если описание невалидное, возвращается 0). На I этапе разработки эти данные просто перенаправляются в response body. 
Response body: 
```ts
{
    calories: number // количество калорий в данном приёме пищи. 
}
```

### II этап разработки

Теперь в обработчике эндпоинта сохранения приёма пищи, помимо получения ответа от LLM и его возвращения, нужно сохранять полученный результат в PostgreSQL, применив sqlalchemy. 

### III этап разработки 

Добавляется новый эндпоинт: `GET /api/v1/stats?user_id=XXX` 

Он должен содержать следующую логику: достать из БД все приёмы пищи за последнюю неделю, соответствующие заданному пользователю, и отправить их в ЛЛМ с таким промптом, чтобы вернулись рекомендации по правильному питанию с учётом сохранённых данных. 
Response body: 
```ts 
{
    "recommendations": string 
}
``` 

### IV этап разработки 

Заменить использование ЛЛМ для получения нутриентов приема пищи (I этап) на использование специализированного Nutritionix API

### V этап разработки 

Возвращать не только калории, но и БЖУ (после выполнения этапа IV это возможно благодря тому, что Nutritionix API предоставляет эти данные). Адаптировать оба эндпоинта и БД под это. 